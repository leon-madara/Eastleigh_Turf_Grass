{"version":3,"file":"preorders.c7080a31.js","sources":["../src/js/broker/modules/preorders.js"],"sourcesContent":["// Preorders Module - Enhanced functionality for preorder management (fixed)\r\n(() => {\r\n    let products = [];\r\n    let preorderItems = [];\r\n    let nextPreorderId = 1;\r\n\r\n    // Local showToast function with fallback\r\n    function showToast(message, type = \"success\") {\r\n        if (typeof window.showToast === \"function\") {\r\n            window.showToast(message, type);\r\n        } else if (window.BrokerDashboard?.showToast) {\r\n            window.BrokerDashboard.showToast(message, type);\r\n        } else {\r\n            console.log(`[${type.toUpperCase()}] ${message}`);\r\n        }\r\n    }\r\n\r\n    // Initialize the preorders module\r\n    async function init() {\r\n        await loadProducts();       // ensure products are ready\r\n        updateUI();\r\n    }\r\n\r\n    // Load products (place products.json in /public/data/ for production)\r\n    async function loadProducts() {\r\n        try {\r\n            const res = await fetch(\"/data/products.json\"); // move file to public/data/\r\n            if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n            products = await res.json();\r\n        } catch (error) {\r\n            console.error(\"Failed to load products:\", error);\r\n            showToast(\"Failed to load products\", \"error\");\r\n            products = [];\r\n        }\r\n    }\r\n\r\n    // Add a new preorder item\r\n    function addPreorder() {\r\n        const preorder = {\r\n            id: nextPreorderId++,\r\n            productId: \"\",\r\n            product: null,\r\n            quantity: 1,\r\n            unitPrice: 0,\r\n            total: 0,\r\n            expectedDate: \"\",\r\n            specialNotes: \"\"\r\n        };\r\n\r\n        preorderItems.push(preorder);\r\n        updateUI();\r\n        showToast(\"Preorder item added\", \"success\");\r\n\r\n        if (window.BrokerDashboard?.updateCartCount) {\r\n            window.BrokerDashboard.updateCartCount(getItemCount());\r\n        }\r\n    }\r\n\r\n    // Remove a preorder item\r\n    function removePreorder(preorderId) {\r\n        preorderItems = preorderItems.filter((p) => p.id !== preorderId);\r\n        updateUI();\r\n        showToast(\"Preorder item removed\", \"success\");\r\n\r\n        if (window.BrokerDashboard?.updateCartCount) {\r\n            window.BrokerDashboard.updateCartCount(getItemCount());\r\n        }\r\n    }\r\n\r\n    // Update preorder details\r\n    function updatePreorder(preorderId, field, value) {\r\n        const preorder = preorderItems.find((p) => p.id === preorderId);\r\n        if (!preorder) return;\r\n\r\n        if (field === \"productId\") {\r\n            const product = products.find((p) => String(p.id) === String(value));\r\n            preorder.productId = value;\r\n            preorder.product = product || null;\r\n            preorder.unitPrice = product ? Number(product.price) || 0 : 0;\r\n            preorder.total = preorder.unitPrice * (Number(preorder.quantity) || 0);\r\n        } else if (field === \"quantity\") {\r\n            const parsed =\r\n                window.numberFormatter?.parseFormattedNumber?.(value) ??\r\n                parseFloat(String(value)) ??\r\n                0;\r\n            preorder.quantity = isNaN(parsed) ? 0 : parsed;\r\n            preorder.total = preorder.unitPrice * preorder.quantity;\r\n        } else if (field === \"expectedDate\") {\r\n            preorder.expectedDate = value;\r\n        } else if (field === \"specialNotes\") {\r\n            preorder.specialNotes = value;\r\n        }\r\n\r\n        updateUI();\r\n    }\r\n\r\n    // Calculate preorder total\r\n    function calculateTotal() {\r\n        return preorderItems.reduce((sum, item) => sum + (Number(item.total) || 0), 0);\r\n    }\r\n\r\n    // Generate preorder message for WhatsApp\r\n    function generatePreorderMessage(preorderData) {\r\n        const { brokerName, brokerEmail, items, expectedDate, specialNotes, total } =\r\n            preorderData;\r\n\r\n        const itemsList = items\r\n            .map((item) => {\r\n                const name = item.product?.name ?? \"Unknown\";\r\n                const thickness = item.product?.thickness ?? \"\";\r\n                return `• ${name} (${thickness})\r\n  Quantity: ${item.quantity} m²\r\n  Unit Price: KES ${Number(item.unitPrice).toLocaleString()}\r\n  Total: KES ${Number(item.total).toLocaleString()}`;\r\n            })\r\n            .join(\"\\n\\n\");\r\n\r\n        return `*BROKER PREORDER SUBMISSION - Eastleigh Turf Grass*\r\n\r\n*Broker Details:*\r\n• Name: ${brokerName}\r\n• Email: ${brokerEmail}\r\n\r\n*Preorder Items:*\r\n${itemsList}\r\n\r\n*Preorder Details:*\r\n• Expected Date: ${expectedDate || \"Not specified\"}\r\n• Special Notes: ${specialNotes || \"None\"}\r\n• Total Amount: KES ${Number(total).toLocaleString()}\r\n\r\n*Submitted:* ${new Date().toLocaleString(\"en-KE\")}`;\r\n    }\r\n\r\n    // Update the UI\r\n    function updateUI() {\r\n        const tableBody = document.getElementById(\"preorderTableBody\");\r\n        const emptyState = document.getElementById(\"emptyPreorderState\");\r\n        const preorderTotal = document.getElementById(\"preorderTotal\");\r\n        const submitBtn = document.getElementById(\"submitPreordersBtn\");\r\n\r\n        if (!tableBody || !emptyState || !preorderTotal || !submitBtn) return;\r\n\r\n        if (preorderItems.length === 0) {\r\n            tableBody.innerHTML = \"\";\r\n            emptyState.style.display = \"block\";\r\n            submitBtn.disabled = true;\r\n        } else {\r\n            emptyState.style.display = \"none\";\r\n            submitBtn.disabled = false;\r\n\r\n            tableBody.innerHTML = preorderItems.map((p) => createPreorderRow(p)).join(\"\");\r\n\r\n            // bind fresh listeners\r\n            preorderItems.forEach((p) => {\r\n                const productSelect = document.getElementById(`preorder-product-${p.id}`);\r\n                const quantityInput = document.getElementById(`preorder-quantity-${p.id}`);\r\n                const dateInput = document.getElementById(`preorder-date-${p.id}`);\r\n                const notesInput = document.getElementById(`preorder-notes-${p.id}`);\r\n                const deleteBtn = document.getElementById(`delete-preorder-${p.id}`);\r\n\r\n                productSelect?.addEventListener(\"change\", (e) =>\r\n                    updatePreorder(p.id, \"productId\", e.target.value)\r\n                );\r\n\r\n                if (quantityInput) {\r\n                    quantityInput.addEventListener(\"input\", (e) =>\r\n                        updatePreorder(p.id, \"quantity\", e.target.value)\r\n                    );\r\n\r\n                    // optional number formatter\r\n                    if (window.numberFormatter?.initInputFormatting) {\r\n                        window.numberFormatter.initInputFormatting(quantityInput, {\r\n                            allowDecimals: true,\r\n                            decimalPlaces: 1,\r\n                            currency: \"KES\"\r\n                        });\r\n                    } else {\r\n                        const iv = setInterval(() => {\r\n                            if (window.numberFormatter?.initInputFormatting) {\r\n                                window.numberFormatter.initInputFormatting(quantityInput, {\r\n                                    allowDecimals: true,\r\n                                    decimalPlaces: 1,\r\n                                    currency: \"KES\"\r\n                                });\r\n                                clearInterval(iv);\r\n                            }\r\n                        }, 100);\r\n                    }\r\n                }\r\n\r\n                dateInput?.addEventListener(\"change\", (e) =>\r\n                    updatePreorder(p.id, \"expectedDate\", e.target.value)\r\n                );\r\n                notesInput?.addEventListener(\"input\", (e) =>\r\n                    updatePreorder(p.id, \"specialNotes\", e.target.value)\r\n                );\r\n                deleteBtn?.addEventListener(\"click\", () => removePreorder(p.id));\r\n            });\r\n        }\r\n\r\n        // Update total\r\n        const total = calculateTotal();\r\n        preorderTotal.textContent = Number(total).toLocaleString(\"en-US\", {\r\n            minimumFractionDigits: 2,\r\n            maximumFractionDigits: 2\r\n        });\r\n    }\r\n\r\n    // Create preorder row HTML\r\n    function createPreorderRow(preorder) {\r\n        const productOptions = products\r\n            .map(\r\n                (product) => `\r\n          <option value=\"${product.id}\" ${String(preorder.productId) === String(product.id) ? \"selected\" : \"\"\r\n                    }>\r\n            ${product.name} (${product.thickness})\r\n          </option>`\r\n            )\r\n            .join(\"\");\r\n\r\n        return `\r\n      <tr>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label for=\"preorder-product-${preorder.id}\">Product Name</label>\r\n            <select class=\"table-select\" id=\"preorder-product-${preorder.id}\">\r\n              <option value=\"\">Select a product</option>\r\n              ${productOptions}\r\n            </select>\r\n          </div>\r\n        </td>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label for=\"preorder-quantity-${preorder.id}\">Quantity (m²)</label>\r\n            <input type=\"number\" inputmode=\"decimal\" class=\"table-input\" id=\"preorder-quantity-${preorder.id}\"\r\n                   value=\"${preorder.quantity}\" min=\"0.1\" step=\"0.1\" placeholder=\"0\">\r\n          </div>\r\n        </td>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label>Unit Price (KES)</label>\r\n            <input type=\"text\" class=\"table-input\" readonly value=\"${Number(\r\n            preorder.unitPrice\r\n        ).toLocaleString(\"en-US\")}\">\r\n          </div>\r\n        </td>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label for=\"preorder-date-${preorder.id}\">Expected Date</label>\r\n            <input type=\"date\" class=\"table-input\" id=\"preorder-date-${preorder.id}\"\r\n                   value=\"${preorder.expectedDate || \"\"}\" placeholder=\"Expected date\">\r\n          </div>\r\n        </td>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label for=\"preorder-notes-${preorder.id}\">Special Notes</label>\r\n            <input type=\"text\" class=\"table-input\" id=\"preorder-notes-${preorder.id}\"\r\n                   value=\"${preorder.specialNotes || \"\"}\" placeholder=\"Special notes\">\r\n          </div>\r\n        </td>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label>Total (KES)</label>\r\n            <strong>${Number(preorder.total).toLocaleString(\"en-US\", {\r\n            minimumFractionDigits: 2,\r\n            maximumFractionDigits: 2\r\n        })}</strong>\r\n          </div>\r\n        </td>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label>Action</label>\r\n            <button class=\"delete-btn\" id=\"delete-preorder-${preorder.id}\">\r\n              <i class=\"fas fa-trash\"></i> Delete\r\n            </button>\r\n          </div>\r\n        </td>\r\n      </tr>`;\r\n    }\r\n\r\n    // Submit preorders\r\n    async function submitPreorders() {\r\n        if (preorderItems.length === 0) {\r\n            showToast(\"No preorder items to submit\", \"error\");\r\n            return;\r\n        }\r\n\r\n        const invalidItems = preorderItems.filter(\r\n            (item) => !item.productId || Number(item.quantity) <= 0\r\n        );\r\n        if (invalidItems.length > 0) {\r\n            showToast(\"Please complete all preorder items before submitting\", \"error\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const preorderData = {\r\n                brokerName: \"Broker User\", // TODO: make dynamic\r\n                brokerEmail: \"broker@eastleighturf.com\", // TODO: make dynamic\r\n                items: preorderItems.map((item) => ({\r\n                    product: item.product,\r\n                    quantity: item.quantity,\r\n                    unitPrice: item.unitPrice,\r\n                    total: item.total\r\n                })),\r\n                expectedDate: preorderItems[0]?.expectedDate || \"Not specified\",\r\n                specialNotes: preorderItems[0]?.specialNotes || \"None\",\r\n                total: calculateTotal()\r\n            };\r\n\r\n            let success = false;\r\n\r\n            if (window.WhatsAppService?.sendPreorderForm) {\r\n                const maybe = window.WhatsAppService.sendPreorderForm(preorderData);\r\n                success = typeof maybe?.then === \"function\" ? await maybe : !!maybe;\r\n            } else {\r\n                const message = generatePreorderMessage(preorderData);\r\n                const whatsappNumber = \"254743375997\";\r\n                const encodedMessage = encodeURIComponent(message);\r\n                const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;\r\n                window.open(whatsappUrl, \"_blank\");\r\n                success = true;\r\n            }\r\n\r\n            if (success) {\r\n                showToast(\r\n                    \"Preorders submitted successfully! WhatsApp will open with your preorder details.\",\r\n                    \"success\"\r\n                );\r\n                preorderItems = [];\r\n                nextPreorderId = 1;\r\n                updateUI();\r\n                if (window.BrokerDashboard?.updateCartCount) {\r\n                    window.BrokerDashboard.updateCartCount(getItemCount());\r\n                }\r\n            } else {\r\n                showToast(\"Failed to send preorders. Please try again.\", \"error\");\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Preorder submission error:\", error);\r\n            showToast(\"An error occurred while submitting the preorders.\", \"error\");\r\n        }\r\n    }\r\n\r\n    // Get item count for cart\r\n    function getItemCount() {\r\n        return preorderItems.length;\r\n    }\r\n\r\n    // Initialize event listeners\r\n    function initEventListeners() {\r\n        document.getElementById(\"addPreorderBtn\")?.addEventListener(\"click\", addPreorder);\r\n        document.getElementById(\"submitPreordersBtn\")?.addEventListener(\"click\", submitPreorders);\r\n    }\r\n\r\n    // Expose module functions\r\n    window.PreordersModule = {\r\n        init,\r\n        addPreorder,\r\n        removePreorder,\r\n        updatePreorder,\r\n        submitPreorders,\r\n        getItemCount\r\n    };\r\n\r\n    // Initialize when DOM is ready\r\n    if (document.readyState === \"loading\") {\r\n        document.addEventListener(\"DOMContentLoaded\", () => {\r\n            init();\r\n            initEventListeners();\r\n        });\r\n    } else {\r\n        init();\r\n        initEventListeners();\r\n    }\r\n})();\r\n"],"names":["products","preorderItems","nextPreorderId","showToast","message","type","_a","init","loadProducts","updateUI","res","error","addPreorder","preorder","getItemCount","removePreorder","preorderId","p","updatePreorder","field","value","_b","product","parsed","calculateTotal","sum","item","generatePreorderMessage","preorderData","brokerName","brokerEmail","items","expectedDate","specialNotes","total","itemsList","name","thickness","tableBody","emptyState","preorderTotal","submitBtn","createPreorderRow","productSelect","quantityInput","dateInput","notesInput","deleteBtn","e","iv","productOptions","submitPreorders","_c","_d","success","maybe","whatsappNumber","encodedMessage","whatsappUrl","initEventListeners"],"mappings":"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"}