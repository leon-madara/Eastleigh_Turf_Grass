const b="modulepreload",T=function(n){return"/Eastleigh_Turf_Grass/"+n},S={},g=function(w,m,C){if(!m||m.length===0)return w();const f=document.getElementsByTagName("link");return Promise.all(m.map(i=>{if(i=T(i),i in S)return;S[i]=!0;const s=i.endsWith(".css"),y=s?'[rel="stylesheet"]':"";if(!!C)for(let r=f.length-1;r>=0;r--){const p=f[r];if(p.href===i&&(!s||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${y}`))return;const l=document.createElement("link");if(l.rel=s?"stylesheet":b,s||(l.as="script",l.crossOrigin=""),l.href=i,document.head.appendChild(l),s)return new Promise((r,p)=>{l.addEventListener("load",r),l.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>w()).catch(i=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=i,window.dispatchEvent(s),!s.defaultPrevented)throw i})};(()=>{let n=[],w=0;function m(){try{C(),r(),I(),k(),window.CartState&&window.CartState.subscribe(t=>{l()})}catch(t){console.warn("Cart initialization failed:",t)}}function C(){const t=localStorage.getItem("eastleighCart");if(t)try{n=JSON.parse(t),h()}catch(e){console.error("Error loading cart from storage:",e),n=[]}}function f(){localStorage.setItem("eastleighCart",JSON.stringify(n))}function i(t){const e=n.findIndex(o=>o.id===t.id&&o.length===t.length&&o.width===t.width);e!==-1?n[e].quantity+=t.quantity:n.push(t),h(),f(),r(),window.CartState&&window.CartState.add(t),v("Item Added",`${t.name} has been added to your cart`,"success")}function s(t){const e=n[t];n.splice(t,1),h(),f(),r(),window.CartState&&window.CartState.remove(e.id),v("Item Removed",`${e.name} has been removed from your cart`,"error")}function y(t,e){if(e<=0){s(t);return}n[t].quantity=e,n[t].total=n[t].area*n[t].price*e,h(),f(),r()}function h(){w=n.reduce((t,e)=>t+e.total,0)}function l(){try{const t=document.getElementById("cartTotal"),e=document.getElementById("applyDiscountBtn"),o=document.getElementById("enterCouponBtn");if(!t)return;const a=n.reduce((d,L)=>d+L.total,0),c=window.CartState?window.CartState.getDiscountAmount():0,u=a-c;if(c>0?t.innerHTML=`
                    <div class="cart-total-breakdown">
                        <div class="subtotal">Subtotal: KES ${a.toLocaleString()}</div>
                        <div class="discount">Discount: -KES ${c.toLocaleString()}</div>
                        <div class="final-total">Total: KES ${u.toLocaleString()}</div>
                    </div>
                `:t.textContent=`KES ${a.toLocaleString()}`,e){const d=window.CartState&&window.CartState.getDiscountAmount()>0;e.innerHTML=d?'<i class="fas fa-check"></i> Discount Applied':'<i class="fas fa-tag"></i> Apply Discount',e.classList.toggle("applied",d)}if(o){const d=window.CartState&&window.CartState.appliedCoupon;o.innerHTML=d?'<i class="fas fa-check"></i> Coupon Applied':'<i class="fas fa-ticket-alt"></i> Enter Coupon',o.classList.toggle("applied",d)}}catch(t){console.warn("Cart summary update failed:",t)}}function r(){try{p(),B()}catch(t){console.warn("Cart display update failed:",t)}}function p(){try{const t=document.getElementById("cartCount"),e=document.getElementById("cartCountBadge"),o=n.reduce((a,c)=>a+c.quantity,0);t&&(t.textContent=o),e&&(e.textContent=o)}catch(t){console.warn("Cart count update failed:",t)}}function B(){try{const t=document.getElementById("cartItems"),e=document.getElementById("cartSummary"),o=document.getElementById("cartTotal");if(!t)return;n.length===0?(t.innerHTML=`
                    <div class="empty-cart">
                        <i class="fas fa-shopping-basket"></i>
                        <p>Your cart is empty</p>
                        <span>Add some products to get started</span>
                    </div>
                `,e&&(e.style.display="none")):(t.innerHTML=n.map((a,c)=>`
                    <div class="cart-item">
                        <div class="cart-item-image">
                            <img src="${a.image}" alt="${a.name}" />
                        </div>
                        <div class="cart-item-details">
                            <div class="cart-item-name">${a.name}</div>
                            <div class="cart-item-dimensions">${a.length}m Ã— ${a.width}m</div>
                            <div class="cart-item-price">KES ${a.total.toLocaleString()}</div>
                        </div>
                        <div class="cart-item-actions">
                            <div class="quantity-controls">
                                <button class="quantity-btn" onclick="window.CartComponent.updateQuantity(${c}, ${a.quantity-1})">-</button>
                                <span class="quantity-display">${a.quantity}</span>
                                <button class="quantity-btn" onclick="window.CartComponent.updateQuantity(${c}, ${a.quantity+1})">+</button>
                            </div>
                            <button class="remove-item-btn" onclick="window.CartComponent.remove(${c})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `).join(""),e&&(e.style.display="block",l()))}catch(t){console.warn("Cart panel update failed:",t)}}function E(){n=[],w=0,f(),r(),window.CartState&&window.CartState.clear(),v("Cart Cleared","All items have been removed from your cart","error")}function v(t,e,o="success"){if(window.ToastService)window.ToastService.show(e||t,o);else{const a=document.getElementById("toast");if(!a)return;const c=a.querySelector(".toast-message"),u=a.querySelector(".toast-icon i");if(c&&(c.textContent=e||t),u)switch(o){case"success":u.className="fas fa-check-circle";break;case"error":u.className="fas fa-exclamation-circle";break;case"warning":u.className="fas fa-exclamation-triangle";break;case"info":u.className="fas fa-info-circle";break;default:u.className="fas fa-check-circle"}a.className=`toast ${o}`,a.classList.remove("hidden"),a.classList.add("show"),setTimeout(()=>{a.classList.remove("show"),setTimeout(()=>{a.classList.add("hidden")},300)},3e3);const d=a.querySelector(".toast-close");d&&d.addEventListener("click",()=>{a.classList.remove("show"),setTimeout(()=>{a.classList.add("hidden")},300)})}}function k(){(window.location.pathname.includes("products.html")||window.location.pathname==="/"&&window.location.hash==="#cart")&&(g(()=>import("./discountModal.a8fef9ff.js"),[]).then(t=>{window.discountModal=t.discountModal}),g(()=>import("./couponModal.03c8ebad.js"),[]).then(t=>{window.couponModal=t.couponModal}),g(()=>import("./checkoutModal.87881386.js"),[]).then(t=>{window.checkoutModal=t.checkoutModal,window.checkoutModal.init()}))}function I(){try{const t=document.getElementById("clearCartBtn");t&&t.addEventListener("click",E);const e=document.getElementById("submitOrderBtn");e&&e.addEventListener("click",()=>{window.checkoutModal?window.checkoutModal.open():window.location.href="/products.html#cart"});const o=document.getElementById("applyDiscountBtn"),a=document.getElementById("enterCouponBtn");o&&o.addEventListener("click",()=>{window.discountModal?window.discountModal.open():window.location.href="/products.html#cart"}),a&&a.addEventListener("click",()=>{window.couponModal?window.couponModal.open():window.location.href="/products.html#cart"})}catch(t){console.warn("Cart events binding failed:",t)}}window.CartComponent={init:m,add:i,remove:s,updateQuantity:y,clear:E,getItems:()=>n,getTotal:()=>w,getCount:()=>n.reduce((t,e)=>t+e.quantity,0)},document.readyState==="loading"?document.addEventListener("DOMContentLoaded",m):m()})();export{g as _};
//# sourceMappingURL=cart.437f89c5.js.map
