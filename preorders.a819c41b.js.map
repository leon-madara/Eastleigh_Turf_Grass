{"version":3,"file":"preorders.a819c41b.js","sources":["../src/js/broker/modules/preorders.js"],"sourcesContent":["// Preorders Module - Enhanced functionality for preorder management (fixed)\r\n(() => {\r\n    let products = [];\r\n    let preorderItems = [];\r\n    let nextPreorderId = 1;\r\n\r\n    // Local showToast function with fallback\r\n    function showToast(message, type = \"success\") {\r\n        if (typeof window.showToast === \"function\") {\r\n            window.showToast(message, type);\r\n        } else if (window.BrokerDashboard?.showToast) {\r\n            window.BrokerDashboard.showToast(message, type);\r\n        } else {\r\n            console.log(`[${type.toUpperCase()}] ${message}`);\r\n        }\r\n    }\r\n\r\n    // Initialize the preorders module\r\n    async function init() {\r\n        await loadProducts();       // ensure products are ready\r\n        updateUI();\r\n    }\r\n\r\n    // Load products (place products.json in /public/data/ for production)\r\n    async function loadProducts() {\r\n        try {\r\n            const res = await fetch(\"/data/products.json\"); // move file to public/data/\r\n            if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n            products = await res.json();\r\n        } catch (error) {\r\n            console.error(\"Failed to load products:\", error);\r\n            showToast(\"Failed to load products\", \"error\");\r\n            products = [];\r\n        }\r\n    }\r\n\r\n    // Add a new preorder item\r\n    function addPreorder() {\r\n        const preorder = {\r\n            id: nextPreorderId++,\r\n            productId: \"\",\r\n            product: null,\r\n            quantity: 1,\r\n            unitPrice: 0,\r\n            total: 0,\r\n            expectedDate: \"\",\r\n            specialNotes: \"\"\r\n        };\r\n\r\n        preorderItems.push(preorder);\r\n        updateUI();\r\n        showToast(\"Preorder item added\", \"success\");\r\n\r\n        if (window.BrokerDashboard?.updateCartCount) {\r\n            window.BrokerDashboard.updateCartCount(getItemCount());\r\n        }\r\n    }\r\n\r\n    // Remove a preorder item\r\n    function removePreorder(preorderId) {\r\n        preorderItems = preorderItems.filter((p) => p.id !== preorderId);\r\n        updateUI();\r\n        showToast(\"Preorder item removed\", \"success\");\r\n\r\n        if (window.BrokerDashboard?.updateCartCount) {\r\n            window.BrokerDashboard.updateCartCount(getItemCount());\r\n        }\r\n    }\r\n\r\n    // Update preorder details\r\n    function updatePreorder(preorderId, field, value) {\r\n        const preorder = preorderItems.find((p) => p.id === preorderId);\r\n        if (!preorder) return;\r\n\r\n        if (field === \"productId\") {\r\n            const product = products.find((p) => String(p.id) === String(value));\r\n            preorder.productId = value;\r\n            preorder.product = product || null;\r\n            preorder.unitPrice = product ? Number(product.price) || 0 : 0;\r\n            preorder.total = preorder.unitPrice * (Number(preorder.quantity) || 0);\r\n        } else if (field === \"quantity\") {\r\n            const parsed =\r\n                window.numberFormatter?.parseFormattedNumber?.(value) ??\r\n                parseFloat(String(value)) ??\r\n                0;\r\n            preorder.quantity = isNaN(parsed) ? 0 : parsed;\r\n            preorder.total = preorder.unitPrice * preorder.quantity;\r\n        } else if (field === \"expectedDate\") {\r\n            preorder.expectedDate = value;\r\n        } else if (field === \"specialNotes\") {\r\n            preorder.specialNotes = value;\r\n        }\r\n\r\n        updateUI();\r\n    }\r\n\r\n    // Calculate preorder total\r\n    function calculateTotal() {\r\n        return preorderItems.reduce((sum, item) => sum + (Number(item.total) || 0), 0);\r\n    }\r\n\r\n    // Generate preorder message for WhatsApp\r\n    function generatePreorderMessage(preorderData) {\r\n        const { brokerName, brokerEmail, items, expectedDate, specialNotes, total } =\r\n            preorderData;\r\n\r\n        const itemsList = items\r\n            .map((item) => {\r\n                const name = item.product?.name ?? \"Unknown\";\r\n                const thickness = item.product?.thickness ?? \"\";\r\n                return `• ${name} (${thickness})\r\n  Quantity: ${item.quantity} m²\r\n  Unit Price: KES ${Number(item.unitPrice).toLocaleString()}\r\n  Total: KES ${Number(item.total).toLocaleString()}`;\r\n            })\r\n            .join(\"\\n\\n\");\r\n\r\n        return `*BROKER PREORDER SUBMISSION - Eastleigh Turf Grass*\r\n\r\n*Broker Details:*\r\n• Name: ${brokerName}\r\n• Email: ${brokerEmail}\r\n\r\n*Preorder Items:*\r\n${itemsList}\r\n\r\n*Preorder Details:*\r\n• Expected Date: ${expectedDate || \"Not specified\"}\r\n• Special Notes: ${specialNotes || \"None\"}\r\n• Total Amount: KES ${Number(total).toLocaleString()}\r\n\r\n*Submitted:* ${new Date().toLocaleString(\"en-KE\")}`;\r\n    }\r\n\r\n    // Update the UI\r\n    function updateUI() {\r\n        const tableBody = document.getElementById(\"preorderTableBody\");\r\n        const emptyState = document.getElementById(\"emptyPreorderState\");\r\n        const preorderTotal = document.getElementById(\"preorderTotal\");\r\n        const submitBtn = document.getElementById(\"submitPreordersBtn\");\r\n\r\n        if (!tableBody || !emptyState || !preorderTotal || !submitBtn) return;\r\n\r\n        if (preorderItems.length === 0) {\r\n            tableBody.innerHTML = \"\";\r\n            emptyState.style.display = \"block\";\r\n            submitBtn.disabled = true;\r\n        } else {\r\n            emptyState.style.display = \"none\";\r\n            submitBtn.disabled = false;\r\n\r\n            tableBody.innerHTML = preorderItems.map((p) => createPreorderRow(p)).join(\"\");\r\n\r\n            // bind fresh listeners\r\n            preorderItems.forEach((p) => {\r\n                const productSelect = document.getElementById(`preorder-product-${p.id}`);\r\n                const quantityInput = document.getElementById(`preorder-quantity-${p.id}`);\r\n                const dateInput = document.getElementById(`preorder-date-${p.id}`);\r\n                const notesInput = document.getElementById(`preorder-notes-${p.id}`);\r\n                const deleteBtn = document.getElementById(`delete-preorder-${p.id}`);\r\n\r\n                productSelect?.addEventListener(\"change\", (e) =>\r\n                    updatePreorder(p.id, \"productId\", e.target.value)\r\n                );\r\n\r\n                if (quantityInput) {\r\n                    quantityInput.addEventListener(\"input\", (e) =>\r\n                        updatePreorder(p.id, \"quantity\", e.target.value)\r\n                    );\r\n\r\n                    // optional number formatter\r\n                    if (window.numberFormatter?.initInputFormatting) {\r\n                        window.numberFormatter.initInputFormatting(quantityInput, {\r\n                            allowDecimals: true,\r\n                            decimalPlaces: 1,\r\n                            currency: \"KES\"\r\n                        });\r\n                    } else {\r\n                        const iv = setInterval(() => {\r\n                            if (window.numberFormatter?.initInputFormatting) {\r\n                                window.numberFormatter.initInputFormatting(quantityInput, {\r\n                                    allowDecimals: true,\r\n                                    decimalPlaces: 1,\r\n                                    currency: \"KES\"\r\n                                });\r\n                                clearInterval(iv);\r\n                            }\r\n                        }, 100);\r\n                    }\r\n                }\r\n\r\n                dateInput?.addEventListener(\"change\", (e) =>\r\n                    updatePreorder(p.id, \"expectedDate\", e.target.value)\r\n                );\r\n                notesInput?.addEventListener(\"input\", (e) =>\r\n                    updatePreorder(p.id, \"specialNotes\", e.target.value)\r\n                );\r\n                deleteBtn?.addEventListener(\"click\", () => removePreorder(p.id));\r\n            });\r\n        }\r\n\r\n        // Update total\r\n        const total = calculateTotal();\r\n        preorderTotal.textContent = Number(total).toLocaleString(\"en-US\", {\r\n            minimumFractionDigits: 2,\r\n            maximumFractionDigits: 2\r\n        });\r\n    }\r\n\r\n    // Create preorder row HTML\r\n    function createPreorderRow(preorder) {\r\n        const productOptions = products\r\n            .map(\r\n                (product) => `\r\n          <option value=\"${product.id}\" ${String(preorder.productId) === String(product.id) ? \"selected\" : \"\"\r\n                    }>\r\n            ${product.name} (${product.thickness})\r\n          </option>`\r\n            )\r\n            .join(\"\");\r\n\r\n        return `\r\n      <tr>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label for=\"preorder-product-${preorder.id}\">Product Name</label>\r\n            <select class=\"table-select\" id=\"preorder-product-${preorder.id}\">\r\n              <option value=\"\">Select a product</option>\r\n              ${productOptions}\r\n            </select>\r\n          </div>\r\n        </td>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label for=\"preorder-quantity-${preorder.id}\">Quantity (m²)</label>\r\n            <input type=\"number\" inputmode=\"decimal\" class=\"table-input\" id=\"preorder-quantity-${preorder.id}\"\r\n                   value=\"${preorder.quantity}\" min=\"0.1\" step=\"0.1\" placeholder=\"0\">\r\n          </div>\r\n        </td>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label>Unit Price (KES)</label>\r\n            <input type=\"text\" class=\"table-input\" readonly value=\"${Number(\r\n            preorder.unitPrice\r\n        ).toLocaleString(\"en-US\")}\">\r\n          </div>\r\n        </td>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label for=\"preorder-date-${preorder.id}\">Expected Date</label>\r\n            <input type=\"date\" class=\"table-input\" id=\"preorder-date-${preorder.id}\"\r\n                   value=\"${preorder.expectedDate || \"\"}\" placeholder=\"Expected date\">\r\n          </div>\r\n        </td>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label for=\"preorder-notes-${preorder.id}\">Special Notes</label>\r\n            <input type=\"text\" class=\"table-input\" id=\"preorder-notes-${preorder.id}\"\r\n                   value=\"${preorder.specialNotes || \"\"}\" placeholder=\"Special notes\">\r\n          </div>\r\n        </td>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label>Total (KES)</label>\r\n            <strong>${Number(preorder.total).toLocaleString(\"en-US\", {\r\n            minimumFractionDigits: 2,\r\n            maximumFractionDigits: 2\r\n        })}</strong>\r\n          </div>\r\n        </td>\r\n        <td>\r\n          <div class=\"order-field\">\r\n            <label>Action</label>\r\n            <button class=\"delete-btn\" id=\"delete-preorder-${preorder.id}\">\r\n              <i class=\"fas fa-trash\"></i> Delete\r\n            </button>\r\n          </div>\r\n        </td>\r\n      </tr>`;\r\n    }\r\n\r\n    // Submit preorders\r\n    async function submitPreorders() {\r\n        if (preorderItems.length === 0) {\r\n            showToast(\"No preorder items to submit\", \"error\");\r\n            return;\r\n        }\r\n\r\n        const invalidItems = preorderItems.filter(\r\n            (item) => !item.productId || Number(item.quantity) <= 0\r\n        );\r\n        if (invalidItems.length > 0) {\r\n            showToast(\"Please complete all preorder items before submitting\", \"error\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const preorderData = {\r\n                brokerName: \"Broker User\", // TODO: make dynamic\r\n                brokerEmail: \"broker@eastleighturf.com\", // TODO: make dynamic\r\n                items: preorderItems.map((item) => ({\r\n                    product: item.product,\r\n                    quantity: item.quantity,\r\n                    unitPrice: item.unitPrice,\r\n                    total: item.total\r\n                })),\r\n                expectedDate: preorderItems[0]?.expectedDate || \"Not specified\",\r\n                specialNotes: preorderItems[0]?.specialNotes || \"None\",\r\n                total: calculateTotal()\r\n            };\r\n\r\n            let success = false;\r\n\r\n            if (window.WhatsAppService?.sendPreorderForm) {\r\n                const maybe = window.WhatsAppService.sendPreorderForm(preorderData);\r\n                success = typeof maybe?.then === \"function\" ? await maybe : !!maybe;\r\n            } else {\r\n                const message = generatePreorderMessage(preorderData);\r\n                const whatsappNumber = \"254743375997\";\r\n                const encodedMessage = encodeURIComponent(message);\r\n                const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;\r\n                window.open(whatsappUrl, \"_blank\");\r\n                success = true;\r\n            }\r\n\r\n            if (success) {\r\n                showToast(\r\n                    \"Preorders submitted successfully! WhatsApp will open with your preorder details.\",\r\n                    \"success\"\r\n                );\r\n                preorderItems = [];\r\n                nextPreorderId = 1;\r\n                updateUI();\r\n                if (window.BrokerDashboard?.updateCartCount) {\r\n                    window.BrokerDashboard.updateCartCount(getItemCount());\r\n                }\r\n            } else {\r\n                showToast(\"Failed to send preorders. Please try again.\", \"error\");\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Preorder submission error:\", error);\r\n            showToast(\"An error occurred while submitting the preorders.\", \"error\");\r\n        }\r\n    }\r\n\r\n    // Get item count for cart\r\n    function getItemCount() {\r\n        return preorderItems.length;\r\n    }\r\n\r\n    // Initialize event listeners\r\n    function initEventListeners() {\r\n        document.getElementById(\"addPreorderBtn\")?.addEventListener(\"click\", addPreorder);\r\n        document.getElementById(\"submitPreordersBtn\")?.addEventListener(\"click\", submitPreorders);\r\n    }\r\n\r\n    // Expose module functions\r\n    window.PreordersModule = {\r\n        init,\r\n        addPreorder,\r\n        removePreorder,\r\n        updatePreorder,\r\n        submitPreorders,\r\n        getItemCount\r\n    };\r\n\r\n    // Initialize when DOM is ready\r\n    if (document.readyState === \"loading\") {\r\n        document.addEventListener(\"DOMContentLoaded\", () => {\r\n            init();\r\n            initEventListeners();\r\n        });\r\n    } else {\r\n        init();\r\n        initEventListeners();\r\n    }\r\n})();\r\n"],"names":["products","preorderItems","nextPreorderId","showToast","message","type","_a","window","BrokerDashboard","console","log","concat","toUpperCase","init","__async","this","res","fetch","ok","Error","status","json","error","loadProducts","addPreorder","preorder","id","productId","product","quantity","unitPrice","total","expectedDate","specialNotes","push","updateCartCount","getItemCount","removePreorder","preorderId","filter","p","updatePreorder","field","value","_b","_c","_d","find","String","Number","price","parsed","numberFormatter","parseFormattedNumber","call","parseFloat","isNaN","calculateTotal","reduce","sum","item","updateUI","tableBody","document","getElementById","emptyState","preorderTotal","submitBtn","length","innerHTML","style","display","disabled","map","productOptions","name","thickness","join","toLocaleString","minimumFractionDigits","maximumFractionDigits","createPreorderRow","forEach","productSelect","quantityInput","dateInput","notesInput","deleteBtn","addEventListener","e","target","initInputFormatting","allowDecimals","decimalPlaces","currency","iv","setInterval","clearInterval","textContent","submitPreorders","preorderData","brokerName","brokerEmail","items","success","WhatsAppService","sendPreorderForm","maybe","then","itemsList","Date","generatePreorderMessage","whatsappNumber","encodedMessage","encodeURIComponent","whatsappUrl","open","initEventListeners","PreordersModule","readyState"],"mappings":"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"}