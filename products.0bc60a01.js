var k=Object.defineProperty;var L=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var P=(t,e,n)=>e in t?k(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_=(t,e)=>{for(var n in e||(e={}))A.call(e,n)&&P(t,n,e[n]);if(L)for(var n of L(e))q.call(e,n)&&P(t,n,e[n]);return t};var B=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var D=(t,e,n)=>new Promise((s,c)=>{var d=a=>{try{m(n.next(a))}catch(v){c(v)}},f=a=>{try{m(n.throw(a))}catch(v){c(v)}},m=a=>a.done?s(a.value):Promise.resolve(a.value).then(d,f);m((n=n.apply(t,e)).next())});import"./toast.ff58a1ab.js";import"./mobile-nav.4ed993c7.js";import"./checkout-modal.4ed993c7.js";import"./broker.4ed993c7.js";import"./broker-login.4ed993c7.js";import{_ as C}from"./toastService.3b9d1098.js";import{c as S,d as E}from"./discountService.a3eed901.js";var V=B(I=>{const F=(()=>{let t=[],e=null,n=null,s=[];function c(){return[...t]}function d(i){const l=Date.now();t.push(_({id:l},i)),u()}function f(i){t=t.filter(l=>l.id!==i),u()}function m(){t=[],e=null,n=null,u()}function a(){return t.reduce((i,l)=>i+l.total,0)}function v(i){const l=a(),p=S.applyCoupon(i,l);return p.valid&&(e=p.coupon,n=null,S.incrementCouponUsage(i)),u(),p}function b(i){const l=a(),p=E.applyPromotion(i,l);return p.valid&&(n=p.promotion,e=null),u(),p}function w(){e=null,n=null,u()}function g(){const i=a();let l=0;return e?l=S.calculateCouponDiscount(e,i):n&&(l=E.calculatePromotionDiscount(n,i)),l}function y(){const i=a(),l=g();return i-l}function o(){const i=a();return E.getAvailablePromotions(i)}function r(){const i=a();return E.getBestPromotion(i)}function u(){const i=a(),l=g(),p=y();s.forEach(T=>{try{T({items:c(),subtotal:i,discountAmount:l,total:p,appliedCoupon:e,appliedPromotion:n})}catch($){console.error("Cart subscriber error:",$)}}),window.renderCartUI&&window.renderCartUI(c(),p,l)}function h(i){return s.push(i),()=>{const l=s.indexOf(i);l>-1&&s.splice(l,1)}}return{getItems:c,add:d,remove:f,clear:m,getSubtotal:a,applyCoupon:v,applyPromotion:b,removeDiscount:w,getDiscountAmount:g,getTotal:y,getAvailablePromotions:o,getBestPromotion:r,subscribe:h}})();function M(t,e){const n=o=>Number.isFinite(o)?o.toLocaleString():"0",s=document.createElement("div");s.className="product-card",s.setAttribute("data-product-id",t.id),s.innerHTML='\n    <div class="product-image">\n      <img src="'.concat(t.image,'" alt="').concat(t.name,'" />\n      <div class="product-badges">\n        <div class="product-badge">').concat(t.thickness,'</div>\n        <div class="product-badge price">\n          KES <span class="price-amount">').concat(n(t.price),'</span>/m²\n        </div>\n      </div>\n    </div>\n\n    <div class="product-content">\n      <h3 class="product-title">').concat(t.name,'</h3>\n\n      <div class="product-section">\n        <h4>Best for</h4>\n        <div class="use-cases">\n          ').concat(t.useCases.map(o=>'<span class="use-case">'.concat(o,"</span>")).join(""),'\n        </div>\n      </div>\n\n      <div class="product-section">\n        <h4>Key Features:</h4>\n        <ul class="features-list">\n          ').concat(t.features.map(o=>"<li>".concat(o,"</li>")).join(""),'\n        </ul>\n      </div>\n\n      <div class="calculator-section">\n        <div class="dimension-inputs">\n          <div class="input-group">\n            <label>Width (m)</label>\n            <input type="number" class="width-input" placeholder="0" min="0" step="0.1" inputmode="decimal" pattern="[0-9]*[.]?[0-9]+" />\n          </div>\n          <div class="input-group">\n            <label>Height (m)</label>\n            <input type="number" class="height-input" placeholder="0" min="0" step="0.1" inputmode="decimal" pattern="[0-9]*[.]?[0-9]+" />\n          </div>\n        </div>\n\n        <button class="calculate-btn">\n          <i class="fas fa-calculator"></i>\n          Calculate\n        </button>\n\n        <div class="calculation-result" style="display:none;">\n          <div class="result-row">\n            <span class="area-label">Area:</span><span class="area-value">0 m²</span>\n          </div>\n          <div class="result-row">\n            <span class="unit-price-label">Unit Price:</span><span class="unit-price">KES 0/m²</span>\n          </div>\n          <div class="result-row">\n            <span class="total-label">Total:</span><span class="total-price">KES 0</span>\n          </div>\n        </div>\n\n        <button class="add-to-cart-btn" disabled>\n          <i class="fas fa-shopping-cart"></i>\n          Add to Cart\n        </button>\n      </div>\n    </div>\n  ');const c=s.querySelector(".width-input"),d=s.querySelector(".height-input"),f=s.querySelector(".calculate-btn"),m=s.querySelector(".calculation-result"),a=s.querySelector(".add-to-cart-btn");let v=null;const b=()=>{const o=parseFloat(c.value)||0,r=parseFloat(d.value)||0;return c.classList.remove("input-valid","input-invalid"),d.classList.remove("input-valid","input-invalid"),o>0&&r>0?(c.classList.add("input-valid"),d.classList.add("input-valid"),{width:o,height:r,isValid:!0}):(o<=0&&c.value!==""&&c.classList.add("input-invalid"),r<=0&&d.value!==""&&d.classList.add("input-invalid"),{width:o,height:r,isValid:!1})},w=()=>{const{width:o,height:r,isValid:u}=b();if(u){const h=o*r,i=h*t.price;s.querySelector(".area-value").textContent="".concat(h.toFixed(2)," m²"),s.querySelector(".unit-price").textContent="KES ".concat(n(t.price),"/m²"),s.querySelector(".total-price").textContent="KES ".concat(n(i)),m.style.display="block",a.disabled=!1,a.dataset.width=String(o),a.dataset.height=String(r),a.dataset.area=String(h),a.dataset.total=String(i)}else m.style.display="none",a.disabled=!0},g=()=>{v&&clearTimeout(v),v=setTimeout(w,300)},y=()=>{c.value="",d.value="",c.classList.remove("input-valid","input-invalid"),d.classList.remove("input-valid","input-invalid"),m.style.display="none",a.disabled=!0,delete a.dataset.width,delete a.dataset.height,delete a.dataset.area,delete a.dataset.total,setTimeout(()=>{c.focus()},100)};return c.addEventListener("blur",g),d.addEventListener("blur",g),c.addEventListener("input",o=>{const r=o.target.value;r&&!/^\d*\.?\d*$/.test(r)&&(o.target.value=r.replace(/[^\d.]/g,"")),b()}),d.addEventListener("input",o=>{const r=o.target.value;r&&!/^\d*\.?\d*$/.test(r)&&(o.target.value=r.replace(/[^\d.]/g,"")),b()}),f.addEventListener("click",w),s.addEventListener("keydown",o=>{o.key==="Enter"&&(o.target===c||o.target===d)?(o.preventDefault(),w()):o.key==="Escape"&&(o.preventDefault(),y())}),a.addEventListener("click",()=>{const o=parseFloat(a.dataset.width||"0"),r=parseFloat(a.dataset.height||"0"),u=parseFloat(a.dataset.area||"0"),h=parseFloat(a.dataset.total||"0"),i={id:t.id,name:t.name,image:t.image,price:t.price,length:r,width:o,area:u,total:h,quantity:1};window.CartComponent&&window.CartComponent.add(i),typeof e=="function"&&e(i),setTimeout(()=>{y()},200)}),s}window.CartState=F;Promise.allSettled([C(()=>import("./checkoutModal.0d0983e5.js"),[]).then(t=>{window.checkoutModal=t.checkoutModal,console.log("Checkout modal loaded")}).catch(t=>console.warn("Checkout modal not available:",t)),C(()=>import("./discountModal.b229b9bd.js"),[]).then(t=>{window.discountModal=t.discountModal,console.log("Discount modal loaded")}).catch(t=>console.warn("Discount modal not available:",t)),C(()=>import("./couponModal.60047bdc.js"),[]).then(t=>{window.couponModal=t.couponModal,console.log("Coupon modal loaded")}).catch(t=>console.warn("Coupon modal not available:",t)),C(()=>import("./BrokerLoginModal.ea229d2e.js"),[]).then(()=>{console.log("Broker login modal loaded")}).catch(t=>console.warn("Broker login modal not available:",t))]);document.addEventListener("DOMContentLoaded",()=>D(I,null,function*(){console.log("Products page loaded");const t=document.getElementById("productsGrid");if(!t){console.error("Products grid not found!");return}console.log("Products grid found, loading products...");try{const e=yield fetch("/src/data/products.json",{cache:"no-cache"});if(!e.ok)throw new Error("HTTP error! status: ".concat(e.status));const n=yield e.json();console.log("Products loaded:",n.length,"products"),n.forEach(s=>{const c=M(s);t.appendChild(c)}),console.log("Product cards added to grid"),window.location.hash==="#cart"&&setTimeout(()=>{const s=document.getElementById("cart");s&&s.scrollIntoView({behavior:"smooth",block:"start"})},500)}catch(e){console.error("Error loading products:",e)}}))});export default V();
