const t={},e=function(e,n,a){if(!n||0===n.length)return e();const o=document.getElementsByTagName("link");return Promise.all(n.map(e=>{if((e=function(t){return"/Eastleigh_Turf_Grass/"+t}(e))in t)return;t[e]=!0;const n=e.endsWith(".css"),c=n?'[rel="stylesheet"]':"";if(!!a)for(let t=o.length-1;t>=0;t--){const a=o[t];if(a.href===e&&(!n||"stylesheet"===a.rel))return}else if(document.querySelector('link[href="'.concat(e,'"]').concat(c)))return;const i=document.createElement("link");return i.rel=n?"stylesheet":"modulepreload",n||(i.as="script",i.crossOrigin=""),i.href=e,document.head.appendChild(i),n?new Promise((t,n)=>{i.addEventListener("load",t),i.addEventListener("error",()=>n(new Error("Unable to preload CSS for ".concat(e))))}):void 0})).then(()=>e()).catch(t=>{const e=new Event("vite:preloadError",{cancelable:!0});if(e.payload=t,window.dispatchEvent(e),!e.defaultPrevented)throw t})};(()=>{let t=[],n=0;function a(){try{!function(){const e=localStorage.getItem("eastleighCart");if(e)try{t=JSON.parse(e),i()}catch(n){console.error("Error loading cart from storage:",n),t=[]}}(),d(),function(){try{const t=document.getElementById("clearCartBtn");t&&t.addEventListener("click",r);const e=document.getElementById("submitOrderBtn");e&&e.addEventListener("click",()=>{if(window.checkoutModal)window.checkoutModal.open();else{const t=u();window.location.href=t+"/products.html#cart"}});const n=document.getElementById("applyDiscountBtn"),a=document.getElementById("enterCouponBtn");n&&n.addEventListener("click",()=>{if(window.discountModal)window.discountModal.open();else{const t=u();window.location.href=t+"/products.html#cart"}}),a&&a.addEventListener("click",()=>{if(window.couponModal)window.couponModal.open();else{const t=u();window.location.href=t+"/products.html#cart"}})}catch(t){console.warn("Cart events binding failed:",t)}}(),(window.location.pathname.includes("products.html")||"/"===window.location.pathname&&"#cart"===window.location.hash)&&(e(()=>import("./discountModal.914921b8.js"),[]).then(t=>{window.discountModal=t.discountModal}),e(()=>import("./couponModal.31dbf64e.js"),[]).then(t=>{window.couponModal=t.couponModal}),e(()=>import("./checkoutModal.d580fe26.js"),[]).then(t=>{window.checkoutModal=t.checkoutModal,window.checkoutModal.init()})),window.CartState&&window.CartState.subscribe(t=>{s()})}catch(n){console.warn("Cart initialization failed:",n)}}function o(){localStorage.setItem("eastleighCart",JSON.stringify(t))}function c(e){const n=t[e];t.splice(e,1),i(),o(),d(),window.CartState&&window.CartState.remove(n.id),l("Item Removed","".concat(n.name," has been removed from your cart"),"error")}function i(){n=t.reduce((t,e)=>t+e.total,0)}function s(){try{const e=document.getElementById("cartTotal"),n=document.getElementById("applyDiscountBtn"),a=document.getElementById("enterCouponBtn");if(!e)return;const o=t.reduce((t,e)=>t+e.total,0),c=window.CartState?window.CartState.getDiscountAmount():0,i=o-c;if(c>0?e.innerHTML='\n                    <div class="cart-total-breakdown">\n                        <div class="subtotal">Subtotal: KES '.concat(o.toLocaleString(),'</div>\n                        <div class="discount">Discount: -KES ').concat(c.toLocaleString(),'</div>\n                        <div class="final-total">Total: KES ').concat(i.toLocaleString(),"</div>\n                    </div>\n                "):e.textContent="KES ".concat(o.toLocaleString()),n){const t=window.CartState&&window.CartState.getDiscountAmount()>0;n.innerHTML=t?'<i class="fas fa-check"></i> Discount Applied':'<i class="fas fa-tag"></i> Apply Discount',n.classList.toggle("applied",t)}if(a){const t=window.CartState&&window.CartState.appliedCoupon;a.innerHTML=t?'<i class="fas fa-check"></i> Coupon Applied':'<i class="fas fa-ticket-alt"></i> Enter Coupon',a.classList.toggle("applied",t)}}catch(e){console.warn("Cart summary update failed:",e)}}function d(){try{!function(){try{const e=document.getElementById("cartCount"),n=document.getElementById("cartCountBadge"),a=t.reduce((t,e)=>t+e.quantity,0);e&&(e.textContent=a),n&&(n.textContent=a)}catch(e){console.warn("Cart count update failed:",e)}}(),function(){try{const e=document.getElementById("cartItems"),n=document.getElementById("cartSummary");document.getElementById("cartTotal");if(!e)return;0===t.length?(e.innerHTML='\n                    <div class="empty-cart">\n                        <i class="fas fa-shopping-basket"></i>\n                        <p>Your cart is empty</p>\n                        <span>Add some products to get started</span>\n                    </div>\n                ',n&&(n.style.display="none")):(e.innerHTML=t.map((t,e)=>'\n                    <div class="cart-item">\n                        <div class="cart-item-image">\n                            <img src="'.concat(t.image,'" alt="').concat(t.name,'" />\n                        </div>\n                        <div class="cart-item-details">\n                            <div class="cart-item-name">').concat(t.name,'</div>\n                            <div class="cart-item-dimensions">').concat(t.length,"m Ã— ").concat(t.width,'m</div>\n                            <div class="cart-item-price">KES ').concat(t.total.toLocaleString(),'</div>\n                        </div>\n                        <div class="cart-item-actions">\n                            <div class="quantity-controls">\n                                <button class="quantity-btn" onclick="window.CartComponent.updateQuantity(').concat(e,", ").concat(t.quantity-1,')">-</button>\n                                <span class="quantity-display">').concat(t.quantity,'</span>\n                                <button class="quantity-btn" onclick="window.CartComponent.updateQuantity(').concat(e,", ").concat(t.quantity+1,')">+</button>\n                            </div>\n                            <button class="remove-item-btn" onclick="window.CartComponent.remove(').concat(e,')">\n                                <i class="fas fa-trash"></i>\n                            </button>\n                        </div>\n                    </div>\n                ')).join(""),n&&(n.style.display="block",s()))}catch(e){console.warn("Cart panel update failed:",e)}}()}catch(e){console.warn("Cart display update failed:",e)}}function r(){t=[],n=0,o(),d(),window.CartState&&window.CartState.clear(),l("Cart Cleared","All items have been removed from your cart","error")}function l(t,e,n="success"){if(window.ToastService)window.ToastService.show(e||t,n);else{const a=document.getElementById("toast");if(!a)return;const o=a.querySelector(".toast-message"),c=a.querySelector(".toast-icon i");if(o&&(o.textContent=e||t),c)switch(n){case"success":default:c.className="fas fa-check-circle";break;case"error":c.className="fas fa-exclamation-circle";break;case"warning":c.className="fas fa-exclamation-triangle";break;case"info":c.className="fas fa-info-circle"}a.className="toast ".concat(n),a.classList.remove("hidden"),a.classList.add("show"),setTimeout(()=>{a.classList.remove("show"),setTimeout(()=>{a.classList.add("hidden")},300)},3e3);const i=a.querySelector(".toast-close");i&&i.addEventListener("click",()=>{a.classList.remove("show"),setTimeout(()=>{a.classList.add("hidden")},300)})}}function u(){return window.location.pathname.includes("/Eastleigh_Turf_Grass/")?"/Eastleigh_Turf_Grass":""}window.CartComponent={init:a,add:function(e){const n=t.findIndex(t=>t.id===e.id&&t.length===e.length&&t.width===e.width);-1!==n?t[n].quantity+=e.quantity:t.push(e),i(),o(),d(),window.CartState&&window.CartState.add(e),l("Item Added","".concat(e.name," has been added to your cart"),"success")},remove:c,updateQuantity:function(e,n){n<=0?c(e):(t[e].quantity=n,t[e].total=t[e].area*t[e].price*n,i(),o(),d())},clear:r,getItems:()=>t,getTotal:()=>n,getCount:()=>t.reduce((t,e)=>t+e.quantity,0)},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",a):a()})();export{e as _};
//# sourceMappingURL=cart.5ce05c2a.js.map
